(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6740163d"],{1777:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"contractListItem"},[e("span",{staticClass:"title"},[e("span",[t._v(t._s(1==t.data.type?"曲库服务合同":"技术综合服务协议"))]),e("span",{staticStyle:{color:"#999999"}},[t._v(t._s(t.stateText))])]),e("van-cell",{attrs:{"is-link":""},on:{click:function(a){return t.goDetail(t.data,t.data.type)}}},[e("span",{attrs:{slot:"title"},slot:"title"},[e("span",[t._v("合同编号：")]),e("span",[t._v(t._s(t.data.number))])]),e("span",{attrs:{slot:"label"},slot:"label"},[e("span",[t._v(t._s(t.data.begin_date))]),e("span",[t._v(t._s(" ")+"至"+t._s(" "))]),e("span",[t._v(t._s(t.data.end_date))])]),t.showStatus?e("div",[1==t.data.approve_state?e("span",{staticClass:"statues1"},[t._v("审批中")]):t._e(),2==t.data.approve_state?e("span",{staticClass:"statues2"},[t._v("审批通过")]):t._e(),3==t.data.approve_state?e("span",{staticClass:"statues3"},[t._v("审批退回")]):t._e()]):t._e()])],1)},n=[],i={props:{showStatus:{type:Boolean,default:!0},data:{type:Object,required:!0},showPersonContract:{type:Boolean,default:!1}},computed:{stateText:function(){var t=null;switch(this.data.state){case 1:t="合同创建中";break;case 2:t="已生效";break;case 3:t="已过期";break;case 4:t="合同终止";break;default:t="合同创建中";break}return t}},methods:{goDetail:function(t,a){this.$router.push({name:"contractDetail",query:{contractID:1==a?t.music_id:t.comprehensive_id,contractType:a,showPersonContract:this.showPersonContract}})}}},o=i,c=(e("5415"),e("b463"),e("2877")),r=Object(c["a"])(o,s,n,!1,null,"31620f5c",null);a["a"]=r.exports},"1fe8":function(t,a,e){t.exports=e.p+"img/error.9a7c2d33.png"},"228a":function(t,a,e){},3382:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pageListBox"},[e("van-pull-refresh",{directives:[{name:"show",rawName:"v-show",value:1==t.pageStatues,expression:"pageStatues == 1"}],on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(a){t.isLoading=a},expression:"isLoading"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[t._t("default",null,{dataList:t.dataList})],2)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.pageStatues,expression:"pageStatues == 0"}],staticClass:"pageLoading"},[e("Loading")],1),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.pageStatues,expression:"pageStatues == 2"}],staticClass:"pageLoading"},[e("Empty",{attrs:{text:t.noListText}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:3==t.pageStatues,expression:"pageStatues == 3"}],staticClass:"pageLoading"},[e("Error",{attrs:{text:"加载失败"},on:{eventBtn:t.onReload}})],1)],1)},n=[],i=e("2909"),o=e("885b"),c=e("ae9f"),r=e("54a1"),l={components:{Loading:r["a"],Empty:o["a"],Error:c["a"]},props:{noListText:{type:String,default:"暂无信息"},getData:{type:Function,required:!0},params:{type:Object,default:function(){}}},watch:{params:{handler:function(t){this.otherParams=t},deep:!0,immediate:!0}},data:function(){return{otherParams:{},dataList:[],isLoading:!1,pageStatues:0,loading:!1,finished:!1,pIndex:1,pSize:30,total:0}},methods:{onReload:function(){this.pageStatues=0,this.pIndex=1,this.finished=!1,this.handlerData()},onRefresh:function(){this.pIndex=1,this.finished=!0,this.handlerData()},onLoadMore:function(){var t=this;this.pIndex++;var a={page_index:this.pIndex,page_size:this.pSize};Object.assign(a,this.otherParams),this.getData(a).then((function(a){var e,s=a.data;(e=t.dataList).push.apply(e,Object(i["a"])(s)),t.loading=!1,t.dataList.length>=t.total&&(t.finished=!0)}))},handlerData:function(){var t=this,a={page_index:this.pIndex,page_size:this.pSize};this.otherParams&&Object.assign(a,this.otherParams),this.getData(a).then((function(a){t.total=a.total,t.dataList=a.data,t.pageStatues=1,t.isLoading=!1,0==t.total?t.pageStatues=2:t.pageStatues=1,t.dataList.length>=t.total?t.finished=!0:t.finished=!1}))["catch"]((function(a){t.pageStatues=3}))}},mounted:function(){this.pageStatues=0,this.handlerData()}},u=l,p=(e("cd5a"),e("2877")),d=Object(p["a"])(u,s,n,!1,null,"2d07b3e3",null);a["a"]=d.exports},4267:function(t,a,e){},"4ada":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"contractBox"},[e("div",{staticClass:"title"},[e("span",[e("span",[t._v(t._s(t.billingText))]),e("span",[e("van-switch",{attrs:{value:t.checked,size:"20px","active-color":t.color},on:{input:t.onInput}})],1)]),e("span",[t.screen?e("van-icon",{attrs:{name:"label",size:"20px"},on:{click:t.popupBtn}}):e("van-icon",{attrs:{name:"label-o",size:"20px"},on:{click:t.popupBtn}})],1)]),e("div",{ref:"scroll",staticClass:"contentBox"},[e("PageList",{ref:"pageList",attrs:{params:t.params,getData:t.getContractList,noListText:"暂无创建合同信息"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.dataList,(function(t,a){return e("ContractListItem",{key:a,attrs:{data:t}})}))}}])})],1),e("van-popup",{style:{width:"280px",height:"100%"},attrs:{position:"right"},on:{close:t.popupCloseEvent},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"popupRightBox"},[e("div",{staticClass:"content"},t._l(t.popupData,(function(a,s){return e("div",{key:s,staticClass:"box"},[e("span",{staticClass:"boxTitle"},[t._v(t._s(a.title))]),e("span",{staticClass:"boxList"},t._l(a.list,(function(s,n){return e("span",{key:n,class:{isSelected:t.popupValue[a.key]==s.id},on:{click:function(e){return t.selectedBtn(a.key,s.id)}}},[t._v(t._s(s.text))])})),0)])})),0),e("div",{staticClass:"bottom"},[e("span",{on:{click:function(a){t.show=!1}}},[t._v("取消")]),e("span",{staticClass:"a",on:{click:t.searchBtn}},[t._v("确定")])])])])],1)},n=[],i=(e("d81d"),e("b64b"),e("f121")),o=e("3382"),c=e("1777"),r=e("71a5"),l=e("b6f9"),u={name:"contract",mixins:[l["b"]],components:{PageList:o["a"],ContractListItem:c["a"]},computed:{color:function(){return this.$store.state.app.theme.color},checked:function(){return 1==this.$store.state.ktv.billingState},billingText:function(){return 1==this.$store.state.ktv.billingState?"停止计费":"开始计费"}},data:function(){return{params:{ktv:this.$store.state.ktv.ktvID},getContractList:r["k"],screen:!1,show:!1,popupValue:{contract_type:0,contract_statue:0,approval_statue:0},searchValue:{contract_type:0,contract_statue:0,approval_statue:0},popupData:i["a"].ktv_contract_data}},watch:{searchValue:{handler:function(t){var a=!1;Object.keys(t).map((function(e){0!=t[e]&&(a=!0)})),this.screen=a},deep:!0}},methods:{popupCloseEvent:function(){Object.assign(this.popupValue,this.searchValue)},searchBtn:function(){var t=this;Object.assign(this.searchValue,this.popupValue),console.log(this.searchValue),this.show=!1,this.params={ktv:this.$store.state.ktv.ktvID,type:this.searchValue.contract_type,state:this.searchValue.contract_statue},this.$nextTick((function(){t.$refs.pageList.onReload()}))},selectedBtn:function(t,a){console.log(t,a),this.popupValue[t]=a},onInput:function(t){var a="计费开关",e=null;e=t?"是否开启计费?":"是否停止计费?",this.$dialog.confirm({title:a,message:e,confirmButtonColor:this.$store.state.app.theme.color,beforeClose:this.startChargingBtn})},startChargingBtn:function(t,a){var e=this,s=this.checked?2:1;if("confirm"===t){var n={contract:{billing_state:s}};Object(r["c"])(n,this.$store.state.ktv.ktvID).then((function(t){console.log(s),e.$store.commit("setBillingState",s),a(),e.$toast("状态修改成功")}))["catch"]((function(t){a(),console.log(t);var s="操作失败！！！";400==t.status&&(s=t.data[0]),e.$toast(s)}))}else a()},popupBtn:function(){this.show=!0}}},p=u,d=(e("e277"),e("2877")),h=Object(d["a"])(p,s,n,!1,null,"9fbd5296",null);a["default"]=h.exports},"51cf":function(t,a,e){},5415:function(t,a,e){"use strict";var s=e("7204"),n=e.n(s);n.a},"54a1":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("van-loading",{attrs:{color:t.color}})],1)},n=[],i={computed:{color:function(){return this.$store.state.app.theme.color}}},o=i,c=e("2877"),r=Object(c["a"])(o,s,n,!1,null,null,null);a["a"]=r.exports},7204:function(t,a,e){},ae20:function(t,a,e){"use strict";var s=e("51cf"),n=e.n(s);n.a},ae9f:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"emptyComponentBox"},[e("img",{attrs:{src:t.imgsrc,alt:""}}),e("span",{staticStyle:{display:"flex","margin-top":"10px"}},[e("span",{staticStyle:{color:"#d0d0d0","font-size":"14px"}},[t._v(" "+t._s(t.text)+" ")]),e("span",{staticClass:"errorTheme",on:{click:t.btn}},[t._v("重新加载")])])])},n=[],i={props:{text:{type:String,default:"加载失败"}},data:function(){return{imgsrc:e("1fe8")}},methods:{btn:function(){this.$emit("eventBtn")}}},o=i,c=(e("ae20"),e("2877")),r=Object(c["a"])(o,s,n,!1,null,"d0775eaa",null);a["a"]=r.exports},b463:function(t,a,e){"use strict";var s=e("4267"),n=e.n(s);n.a},cb0d:function(t,a,e){},cd5a:function(t,a,e){"use strict";var s=e("228a"),n=e.n(s);n.a},e277:function(t,a,e){"use strict";var s=e("cb0d"),n=e.n(s);n.a}}]);
//# sourceMappingURL=chunk-6740163d.081a44a0.js.map