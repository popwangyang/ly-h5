(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cb86c9a"],{1013:function(t,e,s){},"77b8":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"homeBox"},[s("div",{staticClass:"routerView theme"},[s("transition",{attrs:{name:t.transitionName}},[s("keep-alive",{attrs:{include:t.keepAliveList}},[s("router-view")],1)],1)],1),s("BottomBar",{directives:[{name:"show",rawName:"v-show",value:t.showTab,expression:"showTab"}]})],1)},a=[],o=s("2f62"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tabBarBox"},[s("van-tabbar",{attrs:{route:"","active-color":t.activeColor,"inactive-color":"#B7B7B7"}},t._l(t.dataList,(function(e,n){return s("van-tabbar-item",{key:n,attrs:{info:e.info?e.info:"",to:e.path},scopedSlots:t._u([{key:"icon",fn:function(t){return s("img",{attrs:{src:t.active?e.active:e.inactive}})}}],null,!0)},[s("span",{staticClass:"bottonTabText"},[t._v(t._s(e.text))])])})),1)],1)},r=[],c={computed:{dataList(){return this.$store.state.app.theme.tabBottoms},activeColor(){return this.$store.state.app.theme.color}}},u=c,l=(s("790d"),s("2877")),d=Object(l["a"])(u,i,r,!1,null,"9a8fded8",null),h=d.exports,b=s("ba41"),m=s("66df"),p=s("9320"),v=s.n(p);s("c276");class f extends v.a{constructor(t){console.log(t),super(t),this.subscribeKeys=[],this.init()}init(){window.onbeforeunload=()=>{this.disconnect()},this.on("connect",t=>{console.log("连接成功",t)}),this.on("disconnect",t=>{console.log("断开连接",t)}),this.on("error",t=>{console.log("错误连接",t)}),this.connect()}addListeners(t,e){this.hasKey(t)||this.subscribeKeys.push(t),this.subscribe(t,e)}removeListeners(t,e){this.hasKey(t)&&(this.unsubscribe(t),this.subscribeKeys.splice(this.subscribeKeys.indexOf(t),1))}hasKey(t){return this.subscribeKeys.indexOf(t)>-1}}let g=null;const k=()=>new Promise((t,e)=>{console.log(g),null==g?Object(b["b"])().then(e=>{const s=e.data.data.access_token,n=e.data.data.timestamp,a=e.data.data.user;g=new f({url:m["c"],user:a,timestamp:n,token:s}),t(g)}):("disconnected"==g._status&&g.connect(),t(g))});var w=s("ea31"),$={components:{BottomBar:h},computed:{keepAliveList(){return this.$store.state.app.keepAliveList},showTab(){return!(!this.$route.meta||!this.$route.meta.showBottomTab)}},data(){return{transitionName:"slide-none",socketConent:null}},watch:{$route(t,e){document.title=t.meta.title;const s=t.path.split("/").length,n=e.path.split("/").length;this.transitionName=s==n?"slide-none":s<n?"slide-right":"slide-left"}},methods:{...Object(o["b"])(["getUnRead"])},created(){this.$store.commit("SET_THEME",this.$store.state.user.usertype)},mounted(){let t=document.getElementsByTagName("body")[0];t.className=this.$store.state.app.className;let e=this.$store.state.user.ktv_id,s=this.$store.state.user.userID,n=this.$store.state.user.usertype;k().then(t=>{this.socketConent=t,"ktv_clerk"!=n?(this.getUnRead(),t.addListeners(`msg:${s}`,t=>{this.getUnRead()})):t.addListeners(`package:${e}`,t=>{let s={ktv_id_list:e,package_status:2};Object(w["b"])(s).then(t=>{this.$store.commit("setUndelivered",t.data.count)})})})},destroyed(){let t=document.getElementsByTagName("body")[0];t.className="themea",null!=this.socketConent&&this.socketConent.disconnect()}},y=$,_=(s("e897"),s("bcb5"),Object(l["a"])(y,n,a,!1,null,"4d5de3a2",null));e["default"]=_.exports},"790d":function(t,e,s){"use strict";var n=s("1013"),a=s.n(n);a.a},"7b7a":function(t,e,s){},"9d58":function(t,e,s){},bcb5:function(t,e,s){"use strict";var n=s("9d58"),a=s.n(n);a.a},e897:function(t,e,s){"use strict";var n=s("7b7a"),a=s.n(n);a.a},ea31:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){return i}));var n=s("66df");const a=t=>n["b"].request({url:"/order/info",params:t,method:"get"}),o=t=>{let e=t.id;return delete t.id,n["b"].request({url:`/order/package/${e}`,data:t,method:"patch"})},i=t=>n["b"].request({url:`/order/info/${t}`,method:"get"})}}]);
//# sourceMappingURL=chunk-1cb86c9a.de1866e8.js.map